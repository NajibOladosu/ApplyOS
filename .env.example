# ApplyOS Environment Variables
# Copy this file to .env.local and fill in your actual values
# NEVER commit .env.local or any file containing real secrets to git

# ============================================================================
# SUPABASE CONFIGURATION (Required)
# ============================================================================
# Get these from your Supabase project settings: https://app.supabase.com
# Project Settings ‚Üí API

# Public Supabase URL (safe to expose to client-side)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co

# Public anonymous key (safe to expose to client-side)
# This key has Row Level Security (RLS) enforced - users can only access their own data
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here

# Service role key (SERVER-SIDE ONLY - NEVER expose to client)
# WARNING: This key bypasses RLS - only use in server-side code for admin operations
# Used in: API routes, cron jobs, server components
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# ============================================================================
# AI CONFIGURATION (Required for document parsing)
# ============================================================================
# Google Gemini API Key (SERVER-SIDE ONLY)
# Get from: https://makersuite.google.com/app/apikey
# Used for: Document parsing, question extraction, cover letter generation
# Cost: Pay-per-use (monitor usage in Google Cloud Console)
GEMINI_API_KEY=your-gemini-api-key-here

# ============================================================================
# EMAIL CONFIGURATION (Required for notifications and verification emails)
# ============================================================================
# PRIVATE DOMAIN SMTP CONFIGURATION (Recommended)
# Use the SMTP settings provided by your domain email provider
SMTP_HOST=mail.yourdomain.com
SMTP_PORT=587
SMTP_USER=noreply@yourdomain.com
SMTP_PASS=your-private-email-password
SMTP_SECURE=false # Use true for port 465, false for port 587 (STARTTLS)
SMTP_FROM_NAME=ApplyOS
SMTP_FROM_EMAIL=noreply@yourdomain.com

# Admin email for receiving notifications (defaults to SMTP_USER if not set)
ADMIN_EMAIL=admin@yourdomain.com

# DKIM CONFIGURATION (Highly Recommended for preventing Spam)
# Use the DKIM keys generated by your email provider
DKIM_DOMAIN=yourdomain.com
DKIM_SELECTOR=default
# Private key should be provided as a single line with \n for newlines
DKIM_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\n...\n-----END RSA PRIVATE KEY-----"

# Gmail SMTP Configuration (Legacy - NOT RECOMMENDED)
# GMAIL_USER=your-email@gmail.com
# GMAIL_APP_PASSWORD=xxxx xxxx xxxx xxxx

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================
# Your application's public URL
# Used for: Email links, OAuth callbacks, absolute URLs
# Development: http://localhost:3000
# Production: https://www.applyos.io
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ============================================================================
# CRON JOB SECURITY (Required for scheduled tasks)
# ============================================================================
# Secret key for authenticating cron job requests
# Generate a strong random string (e.g., openssl rand -base64 32)
# Used in: Vercel Cron jobs, deadline reminders, weekly digests
# This prevents unauthorized triggering of scheduled tasks
CRON_SECRET=your-cron-secret-here

# ============================================================================
# OPTIONAL: ADVANCED CONFIGURATION
# ============================================================================

# Node Environment (auto-detected by Next.js)
# NODE_ENV=development

# Log Level (default: info)
# Options: error, warn, info, debug
# LOG_LEVEL=info

# Maximum file upload size in MB (default: 10)
# MAX_UPLOAD_SIZE_MB=10

# Maximum files per upload (default: 5)
# MAX_FILES_PER_UPLOAD=5

# AI request timeout in milliseconds (default: 30000)
# AI_REQUEST_TIMEOUT_MS=30000

# Maximum tokens for AI requests (default: 8000)
# AI_REQUEST_MAX_TOKENS=8000

# ============================================================================
# SECURITY NOTES
# ============================================================================
# ‚úÖ Safe to expose client-side:
#    - NEXT_PUBLIC_SUPABASE_URL
#    - NEXT_PUBLIC_SUPABASE_ANON_KEY
#    - NEXT_PUBLIC_APP_URL
#
# ‚ùå NEVER expose client-side (server-only):
#    - SUPABASE_SERVICE_ROLE_KEY
#    - GEMINI_API_KEY
#    - SMTP_HOST
#    - SMTP_USER
#    - SMTP_PASS
#    - CRON_SECRET
#
# üîí Security Best Practices:
#    - Use strong, unique secrets for each environment
#    - Rotate keys regularly (every 90 days recommended)
#    - Never commit .env files to git (already in .gitignore)
#    - Use environment variables in hosting platform (Vercel, etc.)
#    - Monitor API usage and costs (Supabase, Gemini)
#    - Enable audit logging for admin operations
#
# üìä Rate Limiting (configured in lib/middleware/rate-limit.ts):
#    - General API: 100 requests per 15 minutes
#    - Upload endpoints: 10 requests per 15 minutes
#    - AI endpoints: 20 requests per 15 minutes
#    - Auth endpoints: 5 requests per 15 minutes
#    - Email endpoints: 10 requests per hour
#    - Note: Current implementation is in-memory (single-server)
#    - For production scale, upgrade to Upstash Redis (see TODO_UPSTASH_UPGRADE.md)
#
# üîê Database Security:
#    - Row Level Security (RLS) enabled on all tables
#    - Users can only access their own data
#    - Storage bucket secured with user-scoped policies
#    - All cookies use httpOnly, secure, sameSite flags
#
# üåê Network Security:
#    - Content Security Policy (CSP) enforced
#    - X-Frame-Options: DENY (prevent clickjacking)
#    - X-Content-Type-Options: nosniff
#    - Strict-Transport-Security (HSTS) in production
#    - All security headers configured in next.config.js and middleware.ts
#
# ============================================================================
# DEPLOYMENT CHECKLIST
# ============================================================================
# Before deploying to production:
# [ ] All environment variables configured in hosting platform
# [ ] NEXT_PUBLIC_APP_URL set to production domain
# [ ] SMTP credentials tested with /api/email/test
# [ ] CRON_SECRET configured for Vercel Cron jobs
# [ ] Database migrations applied (001-013)
# [ ] Storage bucket policies applied (013_add_storage_bucket_policies.sql)
# [ ] Rate limiting tested under load
# [ ] Security headers verified with securityheaders.com
# [ ] CSP tested for functionality (no console errors)
# [ ] SSL/TLS certificate installed (HTTPS required for production)
# [ ] Monitor API costs (Gemini, Supabase)
# [ ] Set up error tracking (Sentry, etc.)
